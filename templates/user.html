{% extends "base.html" %}
{% block page_title %}
  {% if detail %}Perfil de Usuario{% else %}Directorio de Usuarios{% endif %}
{% endblock %}

{% block content %}

{% if detail and user %}

<a href="/users" class="back-link">← Regresar a Usuarios</a>

<div class="user-profile-wrapper">
  <div class="user-profile-card">
    <div class="user-avatar-xl">{{ user.firstName[0] }}{{ user.lastName[0] }}</div>
    <div class="user-profile-info">
      <h1 class="user-fullname">{{ user.firstName }} {{ user.lastName }}</h1>
      <span class="user-handle">@{{ user.username }}</span>
      <div class="user-details-grid">
        <div class="user-detail-item">
          <span class="detail-label">Email</span>
          <span class="detail-val">{{ user.email }}</span>
        </div>
        <div class="user-detail-item">
          <span class="detail-label">Teléfono</span>
          <span class="detail-val">{{ user.phone }}</span>
        </div>
        <div class="user-detail-item">
          <span class="detail-label">Ciudad</span>
          <span class="detail-val">{{ user.address.city if user.address else '—' }}</span>
        </div>
        <div class="user-detail-item">
          <span class="detail-label">Empresa</span>
          <span class="detail-val">{{ user.company.name if user.company else '—' }}</span>
        </div>
      </div>
    </div>
  </div>

  {% if posts %}
  <section class="user-posts-section">
    <h2 class="section-title">Posts de {{ user.firstName }}</h2>
    <div class="feed-grid">
      {% for post in posts %}
      <article class="card">
        <h3 class="card-title">{{ post.title }}</h3>
        <p class="card-body">{{ post.body[:100] }}…</p>
        <div class="card-footer">
          <span class="reaction-item like">♥ {{ post.reactions.likes if post.reactions else 0 }}</span>
          <a href="/post/{{ post.id }}" class="btn-detail">Ver →</a>
        </div>
      </article>
      {% endfor %}
    </div>
  </section>
  {% endif %}
</div>

{% else %}

<div class="feed-header">
  <h2 class="section-title">Directorio de Usuarios</h2>
  <span class="count-badge">{{ users|length }} usuarios</span>
</div>

<div class="users-grid">
  {% for u in users %}
  <a href="/user/{{ u.id }}" class="user-card">
    <div class="user-avatar">{{ u.firstName[0] }}{{ u.lastName[0] }}</div>
    <div class="user-card-info">
      <span class="user-fullname-sm">{{ u.firstName }} {{ u.lastName }}</span>
      <span class="user-handle-sm">@{{ u.username }}</span>
      <span class="user-company-sm">{{ u.company.name if u.company else '' }}</span>
    </div>
    <span class="arrow-icon">→</span>
  </a>
  {% endfor %}
</div>

{% endif %}
{% endblock %}